"use strict";(self.webpackChunksuuqkaal=self.webpackChunksuuqkaal||[]).push([[7284],{3128:(W,P,s)=>{s.d(P,{B:()=>U,D:()=>B,H:()=>y,R:()=>K});var t=s(92132),E=s(83997),M=s(85829),O=s(42455),g=s(38413),m=s(4198),c=s(55356),l=s(51289),o=s(9005),i=s(46270),r=s(54894),f=s(3643),T=s(25524),_=s(63891);const d=(0,_.Ay)(E.s)`
  svg path {
    fill: ${({theme:a})=>a.colors.neutral600};
  }
`,I=({name:a})=>(0,t.jsxs)(E.s,{background:"primary100",borderStyle:"dashed",borderColor:"primary600",borderWidth:"1px",gap:3,hasRadius:!0,padding:3,shadow:"tableShadow",width:(0,l.pxToRem)(300),children:[(0,t.jsx)(d,{alignItems:"center",background:"neutral200",borderRadius:"50%",height:6,justifyContent:"center",width:6,children:(0,t.jsx)(o.A,{width:`${8/16}rem`})}),(0,t.jsx)(M.o,{fontWeight:"bold",children:a})]}),B=()=>(0,t.jsx)(f.P,{renderItem:a=>{if(a.type===T.D.STAGE)return(0,t.jsx)(I,{name:typeof a.item=="string"?a.item:null})}}),K=({children:a})=>(0,t.jsx)(O.P,{children:(0,t.jsx)(g.g,{tabIndex:-1,children:(0,t.jsx)(m.s,{children:a})})}),U=({href:a})=>{const{formatMessage:C}=(0,r.A)();return(0,t.jsx)(l.Link,{startIcon:(0,t.jsx)(i.A,{}),to:a,children:C({id:"global.back",defaultMessage:"Back"})})},y=({title:a,subtitle:C,navigationAction:A,primaryAction:h})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.SettingsPageTitle,{name:a}),(0,t.jsx)(c.Q,{navigationAction:A,primaryAction:h,title:a,subtitle:C})]})},47284:(W,P,s)=>{s.d(P,{ProtectedReviewWorkflowsPage:()=>V});var t=s(92132),E=s(21272),M=s(83997),O=s(43064),g=s(35513),m=s(40216),c=s(26127),l=s(90361),o=s(33363),i=s(85829),r=s(98765),f=s(25641),T=s(88353),_=s(51289),d=s(5194),I=s(41909),B=s(50612),K=s(54894),U=s(17703),y=s(63891),a=s(3643),C=s(44716),A=s(3128),h=s(45084),H=s(25524),J=s(34540),rs=s(15126),Es=s(63299),ds=s(67014),Ms=s(59080),Ds=s(79275),Ps=s(14718),Os=s(82437),gs=s(61535),ms=s(5790),cs=s(12083),fs=s(35223),vs=s(5409),Ts=s(74930),Cs=s(2600),hs=s(48940),As=s(41286),Rs=s(56336),Ls=s(13426),Ws=s(84624),Is=s(77965),Bs=s(54257),Ks=s(71210),Us=s(51187),ys=s(39404),us=s(58692),js=s(501),xs=s(57646),ws=s(23120),ps=s(44414),Ss=s(25962),Ns=s(14664),$s=s(42588),ks=s(90325),Fs=s(62785),Gs=s(87443),Hs=s(41032),Js=s(22957),zs=s(93179),Qs=s(73055),Vs=s(15747),Xs=s(85306),Ys=s(26509),Zs=s(32058),bs=s(81185),qs=s(82261),st=s(39906);const z=(0,y.Ay)(_.Link)`
  align-items: center;
  height: ${(0,_.pxToRem)(32)};
  display: flex;
  justify-content: center;
  padding: ${({theme:e})=>`${e.spaces[2]}}`};
  width: ${(0,_.pxToRem)(32)};

  svg {
    height: ${(0,_.pxToRem)(12)};
    width: ${(0,_.pxToRem)(12)};

    path {
      fill: ${({theme:e})=>e.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:e})=>e.colors.neutral800};
      }
    }
  }
`,Q=()=>{const{formatMessage:e}=(0,K.A)(),{push:R}=(0,U.W6)(),{trackUsage:p}=(0,_.useTracking)(),[u,j]=E.useState(null),[X,L]=E.useState(!1),{collectionTypes:Y,singleTypes:Z,isLoading:b}=(0,C.u)(),{meta:D,workflows:S,isLoading:x,deleteWorkflow:q}=(0,J.u)(),[ss,N]=E.useState(!1),{_unstableFormatAPIError:ts}=(0,_.useAPIErrorHandler)(),w=(0,_.useNotification)(),{getFeature:os,isLoading:$}=(0,a.m)(),es=(0,a.j)(n=>n.admin_app.permissions.settings?.["review-workflows"]),{allowedActions:{canCreate:k,canDelete:ns}}=(0,_.useRBAC)(es),v=os("review-workflows")?.[H.C],_s=n=>[...Y,...Z].find(G=>G.uid===n)?.info.displayName,as=n=>{j(n)},is=()=>{j(null)},ls=async()=>{if(u)try{N(!0);const n=await q({id:u});if("error"in n){w({type:"warning",message:ts(n.error)});return}j(null),w({type:"success",message:{id:"notification.success.deleted",defaultMessage:"Deleted"}})}catch{w({type:"warning",message:{id:"notification.error.unexpected",defaultMessage:"An error occurred"}})}finally{N(!1)}};return E.useEffect(()=>{!x&&!$&&v&&D&&D?.workflowCount>parseInt(v,10)&&L(!0)},[$,x,D,D?.workflowCount,v]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.H,{primaryAction:k&&(0,t.jsx)(_.LinkButton,{startIcon:(0,t.jsx)(d.A,{}),size:"S",to:"/settings/review-workflows/create",onClick:n=>{v&&D&&D?.workflowCount>=parseInt(v,10)?(n.preventDefault(),L(!0)):p("willCreateWorkflow")},children:e({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})}),subtitle:e({id:"Settings.review-workflows.list.page.subtitle",defaultMessage:"Manage your content review process"}),title:e({id:"Settings.review-workflows.list.page.title",defaultMessage:"Review Workflows"})}),(0,t.jsxs)(A.R,{children:[x||b?(0,t.jsx)(M.s,{justifyContent:"center",children:(0,t.jsx)(O.a,{children:e({id:"Settings.review-workflows.page.list.isLoading",defaultMessage:"Workflows are loading"})})}):(0,t.jsxs)(g.X,{colCount:3,footer:k&&(0,t.jsx)(m.S,{icon:(0,t.jsx)(d.A,{}),onClick:()=>{v&&D&&D?.workflowCount>=parseInt(v,10)?L(!0):(R("/settings/review-workflows/create"),p("willCreateWorkflow"))},children:e({id:"Settings.review-workflows.list.page.create",defaultMessage:"Create new workflow"})}),rowCount:1,children:[(0,t.jsx)(c.d,{children:(0,t.jsxs)(l.Tr,{children:[(0,t.jsx)(o.Th,{children:(0,t.jsx)(i.o,{variant:"sigma",children:e({id:"Settings.review-workflows.list.page.list.column.name.title",defaultMessage:"Name"})})}),(0,t.jsx)(o.Th,{children:(0,t.jsx)(i.o,{variant:"sigma",children:e({id:"Settings.review-workflows.list.page.list.column.stages.title",defaultMessage:"Stages"})})}),(0,t.jsx)(o.Th,{children:(0,t.jsx)(i.o,{variant:"sigma",children:e({id:"Settings.review-workflows.list.page.list.column.contentTypes.title",defaultMessage:"Content Types"})})}),(0,t.jsx)(o.Th,{children:(0,t.jsx)(r.s,{children:e({id:"Settings.review-workflows.list.page.list.column.actions.title",defaultMessage:"Actions"})})})]})}),(0,t.jsx)(f.N,{children:S?.map(n=>(0,E.createElement)(l.Tr,{...(0,_.onRowClick)({fn(F){F.target.nodeName!=="BUTTON"&&R(`/settings/review-workflows/${n.id}`)}}),key:`workflow-${n.id}`},(0,t.jsx)(o.Td,{width:(0,_.pxToRem)(250),children:(0,t.jsx)(i.o,{textColor:"neutral800",fontWeight:"bold",ellipsis:!0,children:n.name})}),(0,t.jsx)(o.Td,{children:(0,t.jsx)(i.o,{textColor:"neutral800",children:n.stages.length})}),(0,t.jsx)(o.Td,{children:(0,t.jsx)(i.o,{textColor:"neutral800",children:(n?.contentTypes??[]).map(_s).join(", ")})}),(0,t.jsx)(o.Td,{children:(0,t.jsxs)(M.s,{alignItems:"center",justifyContent:"end",children:[(0,t.jsx)(z,{to:`/settings/review-workflows/${n.id}`,"aria-label":e({id:"Settings.review-workflows.list.page.list.column.actions.edit.label",defaultMessage:"Edit {name}"},{name:n.name}),children:(0,t.jsx)(I.A,{})}),S.length>1&&ns&&(0,t.jsx)(T.K,{"aria-label":e({id:"Settings.review-workflows.list.page.list.column.actions.delete.label",defaultMessage:"Delete {name}"},{name:"Default workflow"}),icon:(0,t.jsx)(B.A,{}),noBorder:!0,onClick:()=>{as(String(n.id))}})]})})))})]}),(0,t.jsx)(_.ConfirmDialog,{bodyText:{id:"Settings.review-workflows.list.page.delete.confirm.body",defaultMessage:"If you remove this worfklow, all stage-related information will be removed for this content-type. Are you sure you want to remove it?"},isConfirmButtonLoading:ss,isOpen:!!u,onToggleDialog:is,onConfirm:ls}),(0,t.jsxs)(h.L.Root,{isOpen:X,onClose:()=>L(!1),children:[(0,t.jsx)(h.L.Title,{children:e({id:"Settings.review-workflows.list.page.workflows.limit.title",defaultMessage:"You\u2019ve reached the limit of workflows in your plan"})}),(0,t.jsx)(h.L.Body,{children:e({id:"Settings.review-workflows.list.page.workflows.limit.body",defaultMessage:"Delete a workflow or contact Sales to enable more workflows."})})]})]})]})},V=()=>{const e=(0,a.j)(R=>R.admin_app.permissions.settings?.["review-workflows"]?.main);return(0,t.jsx)(_.CheckPagePermissions,{permissions:e,children:(0,t.jsx)(Q,{})})}},44716:(W,P,s)=>{s.d(P,{u:()=>c});var t=s(21272),E=s(51289),M=s(3643);const O=M.n.injectEndpoints({endpoints:l=>({getComponents:l.query({query:()=>({url:"/content-manager/components",method:"GET"}),transformResponse:o=>o.data}),getContentTypes:l.query({query:()=>({url:"/content-manager/content-types",method:"GET"}),transformResponse:o=>o.data})}),overrideExisting:!1}),{useGetComponentsQuery:g,useGetContentTypesQuery:m}=O;function c(){const{_unstableFormatAPIError:l}=(0,E.useAPIErrorHandler)(),o=(0,E.useNotification)(),i=g(),r=m();t.useEffect(()=>{r.error&&o({type:"warning",message:l(r.error)})},[r.error,l,o]),t.useEffect(()=>{i.error&&o({type:"warning",message:l(i.error)})},[i.error,l,o]);const f=i.isLoading||r.isLoading,T=t.useMemo(()=>(r?.data??[]).filter(d=>d.kind==="collectionType"&&d.isDisplayed),[r?.data]),_=t.useMemo(()=>(r?.data??[]).filter(d=>d.kind!=="collectionType"&&d.isDisplayed),[r?.data]);return{isLoading:f,components:t.useMemo(()=>i?.data??[],[i?.data]),collectionTypes:T,singleTypes:_}}},34540:(W,P,s)=>{s.d(P,{u:()=>E});var t=s(39906);function E(M={}){const{id:O="",...g}=M,{data:m,isLoading:c}=(0,t.c)({id:O,populate:"stages",...g}),[l]=(0,t.d)(),[o]=(0,t.e)(),[i]=(0,t.f)(),{workflows:r,meta:f}=m??{};return{meta:f,workflows:r,isLoading:c,createWorkflow:l,updateWorkflow:o,deleteWorkflow:i}}}}]);
